CC=@CC@
RM=@RM@
IRCDLIBS=@LIBS@ ../zlib/libz.a
INCLUDEDIR=-I../include -I../zlib

# malloc package is commented out until we find a better behaved one
SRC_1 = bsd.c channel.c class.c dbuf.c mtrie_conf.c # malloc-2.6.1.c
SRC_2 = hash.c inet_addr.c ircd.c ircsprintf.c dline_conf.c
SRC_3 = list.c match.c packet.c parse.c res.c s_zip.c fdlist.c
SRC_4 = s_auth.c s_bsd.c s_conf.c s_debug.c s_err.c s_misc.c s_numeric.c
SRC_5 = s_serv.c s_user.c send.c support.c whowas.c scache.c blalloc.c
RES_SRC =

# Do it this way for Ultrix, and its portable at least
# just make sure OBJ's match SRC's (pointed out by Ian)
# 
OBJ_1 = bsd.o channel.o class.o dbuf.o mtrie_conf.o # malloc-2.6.1.o
OBJ_2 = hash.o inet_addr.o ircd.o ircsprintf.o dline_conf.o
OBJ_3 = list.o match.o packet.o parse.o res.o s_zip.o fdlist.o
OBJ_4 = s_auth.o s_bsd.o s_conf.o s_debug.o s_err.o s_misc.o s_numeric.o
OBJ_5 = s_serv.o s_user.o send.o support.o whowas.o scache.o blalloc.o

#This is only for very old systems that NEED this
#RES_SRC = res_mkquery.c res_init.c res_comp.c
#RES_OBJ = res_mkquery.o res_init.o res_comp.o

SOURCES = $(SRC_1) $(SRC_2) $(SRC_3) $(SRC_4) $(SRC_5) $(RES_SRC)
#OBJECTS = $(SOURCES:.c=.o) version.o
OBJECTS = $(OBJ_1) $(OBJ_2) $(OBJ_3) $(OBJ_4) $(OBJ_5) $(RES_OBJ) version.o

all: ircd

build: all

# Yuck - don't use this.
depend:
	makedepend $(INCLUDE) $(SOURCES)

clean:
	$(RM) -f $(OBJECTS) *~ ircd.core core ircd 

distclean: clean
	$(RM) -f Makefile version.c.last

.c.o:
	$(CC) $(CFLAGS) $(INCLUDEDIR) -c $<

ircd: $(OBJECTS)
	$(CC) ${LDFLAGS} -o ircd $(OBJECTS) $(IRCDLIBS)
	mv version.c version.c.last

install: build
	@echo "Please do a make install from the top level directory"

version.c: version.c.SH
	/bin/sh ./version.c.SH


# DO NOT DELETE

blalloc.o: ../include/struct.h ../include/config.h ../include/setup.h
blalloc.o: ../include/defs.h ../zlib/zlib.h ../zlib/zconf.h ../include/hash.h
blalloc.o: ../include/class.h ../include/dbuf.h ../include/common.h
blalloc.o: ../include/sys.h ../include/h.h ../include/mtrie_conf.h
blalloc.o: ../include/fdlist.h ../include/numeric.h ../include/blalloc.h
bsd.o: ../include/struct.h ../include/config.h ../include/setup.h
bsd.o: ../include/defs.h ../zlib/zlib.h ../zlib/zconf.h ../include/hash.h
bsd.o: ../include/class.h ../include/dbuf.h ../include/common.h
bsd.o: ../include/sys.h ../include/h.h ../include/mtrie_conf.h
bsd.o: ../include/fdlist.h
channel.o: ../include/struct.h ../include/config.h ../include/setup.h
channel.o: ../include/defs.h ../zlib/zlib.h ../zlib/zconf.h ../include/hash.h
channel.o: ../include/class.h ../include/dbuf.h ../include/common.h
channel.o: ../include/sys.h ../include/numeric.h ../include/channel.h
channel.o: ../include/h.h ../include/mtrie_conf.h ../include/fdlist.h
class.o: ../include/struct.h ../include/config.h ../include/setup.h
class.o: ../include/defs.h ../zlib/zlib.h ../zlib/zconf.h ../include/hash.h
class.o: ../include/class.h ../include/dbuf.h ../include/common.h
class.o: ../include/numeric.h ../include/h.h ../include/mtrie_conf.h
class.o: ../include/fdlist.h
dbuf.o: ../include/struct.h ../include/config.h ../include/setup.h
dbuf.o: ../include/defs.h ../zlib/zlib.h ../zlib/zconf.h ../include/hash.h
dbuf.o: ../include/class.h ../include/dbuf.h ../include/common.h
dbuf.o: ../include/sys.h ../include/h.h ../include/mtrie_conf.h
dbuf.o: ../include/fdlist.h
dline_conf.o: ../include/struct.h ../include/config.h ../include/setup.h
dline_conf.o: ../include/defs.h ../zlib/zlib.h ../zlib/zconf.h
dline_conf.o: ../include/hash.h ../include/class.h ../include/dbuf.h
dline_conf.o: ../include/common.h ../include/sys.h ../include/numeric.h
dline_conf.o: ../include/inet.h ../include/h.h ../include/mtrie_conf.h
dline_conf.o: ../include/fdlist.h ../include/dline_conf.h
fdlist.o: ../include/struct.h ../include/config.h ../include/setup.h
fdlist.o: ../include/defs.h ../zlib/zlib.h ../zlib/zconf.h ../include/hash.h
fdlist.o: ../include/class.h ../include/dbuf.h ../include/common.h
fdlist.o: ../include/sys.h ../include/h.h ../include/mtrie_conf.h
fdlist.o: ../include/fdlist.h
hash.o: ../include/struct.h ../include/config.h ../include/setup.h
hash.o: ../include/defs.h ../zlib/zlib.h ../zlib/zconf.h ../include/hash.h
hash.o: ../include/class.h ../include/dbuf.h ../include/common.h
hash.o: ../include/sys.h ../include/numeric.h ../include/msg.h ../include/h.h
hash.o: ../include/mtrie_conf.h ../include/fdlist.h
inet_addr.o: ../include/setup.h ../include/struct.h ../include/config.h
inet_addr.o: ../include/defs.h ../zlib/zlib.h ../zlib/zconf.h
inet_addr.o: ../include/hash.h ../include/class.h ../include/dbuf.h
inet_addr.o: ../include/common.h ../include/sys.h ../include/nameser.h
inet_addr.o: ../include/resolv.h
ircd.o: ../include/struct.h ../include/config.h ../include/setup.h
ircd.o: ../include/defs.h ../zlib/zlib.h ../zlib/zconf.h ../include/hash.h
ircd.o: ../include/class.h ../include/dbuf.h ../include/common.h
ircd.o: ../include/dline_conf.h ../include/sys.h ../include/numeric.h
ircd.o: ../include/msg.h ../include/inet.h ../include/h.h
ircd.o: ../include/mtrie_conf.h ../include/fdlist.h
list.o: ../include/struct.h ../include/config.h ../include/setup.h
list.o: ../include/defs.h ../zlib/zlib.h ../zlib/zconf.h ../include/hash.h
list.o: ../include/class.h ../include/dbuf.h ../include/common.h
list.o: ../include/sys.h ../include/h.h ../include/mtrie_conf.h
list.o: ../include/fdlist.h ../include/numeric.h ../include/blalloc.h
match.o: ../include/struct.h ../include/config.h ../include/setup.h
match.o: ../include/defs.h ../zlib/zlib.h ../zlib/zconf.h ../include/hash.h
match.o: ../include/class.h ../include/dbuf.h ../include/common.h
match.o: ../include/sys.h
mtrie_conf.o: ../include/sys.h ../include/setup.h ../zlib/zlib.h
mtrie_conf.o: ../zlib/zconf.h ../include/numeric.h ../include/common.h
mtrie_conf.o: ../include/struct.h ../include/config.h ../include/defs.h
mtrie_conf.o: ../include/hash.h ../include/class.h ../include/dbuf.h
mtrie_conf.o: ../include/h.h ../include/mtrie_conf.h ../include/fdlist.h
mtrie_conf.o: ../include/dline_conf.h
packet.o: ../include/struct.h ../include/config.h ../include/setup.h
packet.o: ../include/defs.h ../zlib/zlib.h ../zlib/zconf.h ../include/hash.h
packet.o: ../include/class.h ../include/dbuf.h ../include/common.h
packet.o: ../include/sys.h ../include/msg.h ../include/h.h
packet.o: ../include/mtrie_conf.h ../include/fdlist.h
parse.o: ../include/struct.h ../include/config.h ../include/setup.h
parse.o: ../include/defs.h ../zlib/zlib.h ../zlib/zconf.h ../include/hash.h
parse.o: ../include/class.h ../include/dbuf.h ../include/common.h
parse.o: ../include/msg.h ../include/sys.h ../include/numeric.h
parse.o: ../include/h.h ../include/mtrie_conf.h ../include/fdlist.h
res.o: ../include/struct.h ../include/config.h ../include/setup.h
res.o: ../include/defs.h ../zlib/zlib.h ../zlib/zconf.h ../include/hash.h
res.o: ../include/class.h ../include/dbuf.h ../include/common.h
res.o: ../include/sys.h ../include/res.h ../include/numeric.h ../include/h.h
res.o: ../include/mtrie_conf.h ../include/fdlist.h ../include/nameser.h
res.o: ../include/resolv.h ../include/inet.h
res_comp.o: ../include/nameser.h
res_init.o: ../include/config.h ../include/setup.h ../include/defs.h
res_init.o: ../include/sys.h ../zlib/zlib.h ../zlib/zconf.h
res_init.o: ../include/nameser.h ../include/resolv.h
res_mkquery.o: ../include/config.h ../include/setup.h ../include/defs.h
res_mkquery.o: ../include/sys.h ../zlib/zlib.h ../zlib/zconf.h
res_mkquery.o: ../include/nameser.h ../include/resolv.h
s_auth.o: ../include/struct.h ../include/config.h ../include/setup.h
s_auth.o: ../include/defs.h ../zlib/zlib.h ../zlib/zconf.h ../include/hash.h
s_auth.o: ../include/class.h ../include/dbuf.h ../include/common.h
s_auth.o: ../include/sys.h ../include/res.h ../include/numeric.h
s_auth.o: ../include/patchlevel.h ../include/sock.h ../include/h.h
s_auth.o: ../include/mtrie_conf.h ../include/fdlist.h
s_bsd.o: ../include/struct.h ../include/config.h ../include/setup.h
s_bsd.o: ../include/defs.h ../zlib/zlib.h ../zlib/zconf.h ../include/hash.h
s_bsd.o: ../include/class.h ../include/dbuf.h ../include/common.h
s_bsd.o: ../include/sys.h ../include/res.h ../include/numeric.h
s_bsd.o: ../include/patchlevel.h ../include/inet.h ../include/nameser.h
s_bsd.o: ../include/resolv.h ../include/h.h ../include/mtrie_conf.h
s_bsd.o: ../include/fdlist.h
s_conf.o: ../include/struct.h ../include/config.h ../include/setup.h
s_conf.o: ../include/defs.h ../zlib/zlib.h ../zlib/zconf.h ../include/hash.h
s_conf.o: ../include/class.h ../include/dbuf.h ../include/common.h
s_conf.o: ../include/dline_conf.h ../include/sys.h ../include/numeric.h
s_conf.o: ../include/inet.h ../include/h.h ../include/mtrie_conf.h
s_conf.o: ../include/fdlist.h
s_debug.o: ../include/struct.h ../include/config.h ../include/setup.h
s_debug.o: ../include/defs.h ../zlib/zlib.h ../zlib/zconf.h ../include/hash.h
s_debug.o: ../include/class.h ../include/dbuf.h ../include/numeric.h
s_debug.o: ../include/common.h ../include/sys.h ../include/h.h
s_debug.o: ../include/mtrie_conf.h ../include/fdlist.h
s_err.o: ../include/struct.h ../include/config.h ../include/setup.h
s_err.o: ../include/defs.h ../zlib/zlib.h ../zlib/zconf.h ../include/hash.h
s_err.o: ../include/class.h ../include/dbuf.h ../include/numeric.h
s_err.o: ../include/h.h ../include/mtrie_conf.h ../include/fdlist.h
s_misc.o: ../include/struct.h ../include/config.h ../include/setup.h
s_misc.o: ../include/defs.h ../zlib/zlib.h ../zlib/zconf.h ../include/hash.h
s_misc.o: ../include/class.h ../include/dbuf.h ../include/common.h
s_misc.o: ../include/sys.h ../include/numeric.h ../include/h.h
s_misc.o: ../include/mtrie_conf.h ../include/fdlist.h
s_numeric.o: ../include/struct.h ../include/config.h ../include/setup.h
s_numeric.o: ../include/defs.h ../zlib/zlib.h ../zlib/zconf.h
s_numeric.o: ../include/hash.h ../include/class.h ../include/dbuf.h
s_numeric.o: ../include/common.h ../include/sys.h ../include/numeric.h
s_numeric.o: ../include/h.h ../include/mtrie_conf.h ../include/fdlist.h
s_serv.o: ../include/struct.h ../include/config.h ../include/setup.h
s_serv.o: ../include/defs.h ../zlib/zlib.h ../zlib/zconf.h ../include/hash.h
s_serv.o: ../include/class.h ../include/dbuf.h ../include/common.h
s_serv.o: ../include/sys.h ../include/numeric.h ../include/msg.h
s_serv.o: ../include/channel.h ../include/nameser.h ../include/resolv.h
s_serv.o: ../include/h.h ../include/mtrie_conf.h ../include/fdlist.h
s_serv.o: ../include/dline_conf.h
s_user.o: ../include/struct.h ../include/config.h ../include/setup.h
s_user.o: ../include/defs.h ../zlib/zlib.h ../zlib/zconf.h ../include/hash.h
s_user.o: ../include/class.h ../include/dbuf.h ../include/common.h
s_user.o: ../include/sys.h ../include/numeric.h ../include/msg.h
s_user.o: ../include/channel.h ../include/h.h ../include/mtrie_conf.h
s_user.o: ../include/fdlist.h ../include/blalloc.h
s_zip.o: ../include/struct.h ../include/config.h ../include/setup.h
s_zip.o: ../include/defs.h ../zlib/zlib.h ../zlib/zconf.h ../include/hash.h
s_zip.o: ../include/class.h ../include/dbuf.h ../include/sys.h ../include/h.h
s_zip.o: ../include/mtrie_conf.h ../include/fdlist.h
scache.o: ../include/struct.h ../include/config.h ../include/setup.h
scache.o: ../include/defs.h ../zlib/zlib.h ../zlib/zconf.h ../include/hash.h
scache.o: ../include/class.h ../include/dbuf.h ../include/common.h
scache.o: ../include/sys.h ../include/numeric.h ../include/h.h
scache.o: ../include/mtrie_conf.h ../include/fdlist.h
send.o: ../include/struct.h ../include/config.h ../include/setup.h
send.o: ../include/defs.h ../zlib/zlib.h ../zlib/zconf.h ../include/hash.h
send.o: ../include/class.h ../include/dbuf.h ../include/common.h
send.o: ../include/sys.h ../include/h.h ../include/mtrie_conf.h
send.o: ../include/fdlist.h ../include/numeric.h
support.o: ../include/struct.h ../include/config.h ../include/setup.h
support.o: ../include/defs.h ../zlib/zlib.h ../zlib/zconf.h ../include/hash.h
support.o: ../include/class.h ../include/dbuf.h ../include/common.h
support.o: ../include/sys.h
whowas.o: ../include/struct.h ../include/config.h ../include/setup.h
whowas.o: ../include/defs.h ../zlib/zlib.h ../zlib/zconf.h ../include/hash.h
whowas.o: ../include/class.h ../include/dbuf.h ../include/common.h
whowas.o: ../include/sys.h ../include/numeric.h ../include/h.h
whowas.o: ../include/mtrie_conf.h ../include/fdlist.h
